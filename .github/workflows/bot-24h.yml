name: ğŸ¤– Nikolas Bot - GitHub Only 24/7

on:
  # Run every hour continuously
  schedule:
    - cron: "0 * * * *"

  # Run on push to main
  push:
    branches:
      - main
      - master

  # Allow manual trigger
  workflow_dispatch:

jobs:
  nikolas-bot:
    runs-on: ubuntu-latest
    name: Bot Session

    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup Node.js 20.x
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"
          cache: "npm"

      - name: ğŸ“š Install dependencies
        run: npm ci

      - name: ğŸ—ï¸ Build bot
        run: npm run build

      - name: ğŸš€ Start Nikolas Bot
        timeout-minutes: 50
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘   ğŸ¤– NIKOLAS BOT - STARTING ON GITHUB  â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "â° Start Time: $(date)"
          echo "ğŸ”„ Running bot for ~50 minutes..."
          echo ""

          npm run preview &
          BOT_PID=$!

          sleep 5

          echo "âœ… Bot process started (PID: $BOT_PID)"
          echo ""
          echo "ğŸ“Š Bot Metrics:"
          echo "  â€¢ Node: $(node --version)"
          echo "  â€¢ NPM: $(npm --version)"
          echo "  â€¢ Platform: $(uname -a)"
          echo ""

          # Keep bot running for 50 minutes (job timeout is 55)
          for i in {1..50}; do
            echo "[$(date '+%H:%M:%S')] Bot running - Minute $i/50 âœ¨"
            sleep 60
          done

          echo ""
          echo "â¹ï¸ Stopping bot gracefully..."
          kill $BOT_PID 2>/dev/null || true
          wait $BOT_PID 2>/dev/null || true

          echo "âœ… Bot session completed"

      - name: ğŸ“ˆ Session Report
        if: always()
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘   ğŸ“Š SESSION REPORT                    â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "âœ… Session completed: $(date)"
          echo "â° Duration: ~50 minutes"
          echo "ğŸ”„ Next session: In 1 hour (auto-scheduled)"
          echo ""
          echo "ğŸ¯ Bot Features Running:"
          echo "  âœ“ 7 Laws Analysis"
          echo "  âœ“ Worm Logic Filter"
          echo "  âœ“ Trend Bias Detection"
          echo "  âœ“ Accuracy Boost System"
          echo "  âœ“ Self-Learning Algorithm"
          echo "  âœ“ Persistent Data Storage"
          echo ""
          echo "ğŸ“ Status: ACTIVE & RUNNING 24/7 âœ¨"
